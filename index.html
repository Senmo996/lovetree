<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å›½è€ƒä¸Šå²¸é¢„æµ‹å™¨</title>
    <style>
        /* å…¨å±€é‡ç½®ä¸åŸºç¡€æ ·å¼ */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f5f7fa;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: #333;
            overflow: hidden; /* é˜²æ­¢çƒŸèŠ±æ’‘å‡ºæ»šåŠ¨æ¡ */
        }

        /* çƒŸèŠ±ç”»å¸ƒï¼šè¦†ç›–å…¨å±ï¼Œä¸å¯ç‚¹å‡» */
        #fireworks-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 999; /* åœ¨æœ€é¡¶å±‚ */
            pointer-events: none; /* è®©é¼ æ ‡äº‹ä»¶ç©¿é€ï¼Œä¸å½±å“ä¸‹æ–¹æŒ‰é’®ç‚¹å‡» */
        }

        /* ä¸»å®¹å™¨å¡ç‰‡ */
        .container {
            width: 90%;
            max-width: 400px;
            background: #ffffff;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 30px 20px;
            text-align: center;
            position: relative;
            z-index: 10; /* ä¿è¯å†…å®¹åœ¨èƒŒæ™¯ä¹‹ä¸Š */
        }

        h1 {
            font-size: 24px;
            margin-bottom: 25px;
            color: #d93025;
            font-weight: bold;
        }

        .form-group {
            margin-bottom: 15px;
            text-align: left;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
            color: #666;
        }

        input, select {
            width: 100%;
            padding: 12px 10px;
            border: 1px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            outline: none;
            background-color: #fdfdfd;
            appearance: none;
            -webkit-appearance: none;
        }

        input:focus, select:focus {
            border-color: #d93025;
            background-color: #fff;
        }

        .date-row {
            display: flex;
            gap: 8px;
        }
        
        .select-wrapper {
            position: relative;
            flex: 1;
        }

        .select-wrapper::after {
            content: "â–¼";
            font-size: 10px;
            color: #999;
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
        }

        .btn-predict {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #ff6b6b, #d93025);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
            box-shadow: 0 4px 10px rgba(217, 48, 37, 0.3);
            -webkit-tap-highlight-color: transparent;
        }

        .btn-predict:active {
            transform: scale(0.98);
        }

        .progress-container {
            margin-top: 30px;
            display: none;
        }

        .progress-label {
            margin-bottom: 10px;
            font-size: 14px;
            color: #666;
        }

        .progress-bar-bg {
            width: 100%;
            height: 12px;
            background-color: #eee;
            border-radius: 6px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #ff9a9e 0%, #d93025 100%);
            border-radius: 6px;
        }

        .result-container {
            display: none;
            margin-top: 20px;
            animation: fadeIn 0.8s ease;
        }

        .result-text {
            font-size: 19px;
            line-height: 1.6;
            color: #333;
            font-weight: bold;
        }

        .highlight {
            color: #d93025;
            font-size: 24px;
            display: inline-block;
            margin: 0 2px;
        }

        .exam-info {
            color: #555;
            font-weight: normal;
        }

        .success-icon {
            font-size: 60px;
            margin-bottom: 15px;
            display: block;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .btn-reset {
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.9); /* åŠé€æ˜èƒŒæ™¯ï¼Œé˜²æ­¢çƒŸèŠ±å¤ªèŠ±çœ‹ä¸æ¸…æŒ‰é’® */
            border: 1px solid #ccc;
            color: #666;
            padding: 8px 25px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            position: relative; /* é…åˆ z-index */
            z-index: 20;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes popIn {
            from { transform: scale(0); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

    </style>
</head>
<body>

<canvas id="fireworks-canvas"></canvas>

<div class="container">
    <div id="input-section">
        <h1>ğŸ“ å›½è€ƒä¸Šå²¸é¢„æµ‹å™¨</h1>
        
        <div class="form-group">
            <label for="username">å§“å</label>
            <input type="text" id="username" placeholder="è¯·è¾“å…¥ä½ çš„åå­—">
        </div>
        
        <div class="form-group">
            <label>è€ƒè¯•æ—¶é—´</label>
            <div class="date-row">
                <div class="select-wrapper">
                    <select id="sel-year"><option value="" disabled selected>å¹´</option></select>
                </div>
                <div class="select-wrapper">
                    <select id="sel-month"><option value="" disabled selected>æœˆ</option></select>
                </div>
                <div class="select-wrapper">
                    <select id="sel-day"><option value="" disabled selected>æ—¥</option></select>
                </div>
            </div>
        </div>
        
        <div class="form-group">
            <label for="exam-loc">è€ƒè¯•åœ°ç‚¹</label>
            <input type="text" id="exam-loc" placeholder="ä¾‹å¦‚ï¼šåŒ—äº¬ / æŸæŸä¸­å­¦">
        </div>

        <button class="btn-predict" onclick="startPrediction()">å¼€å§‹é¢„æµ‹</button>
    </div>

    <div id="progress-section" class="progress-container">
        <div class="progress-label" id="progress-text">æ­£åœ¨åˆå§‹åŒ–... 0%</div>
        <div class="progress-bar-bg">
            <div class="progress-bar-fill" id="progress-fill"></div>
        </div>
    </div>

    <div id="result-section" class="result-container">
        <span class="success-icon">ğŸ‰</span>
        <div class="result-text" id="result-content"></div>
        <button class="btn-reset" onclick="resetPage()">å†æµ‹ä¸€æ¬¡</button>
    </div>
</div>

<script>
    // --- é¡µé¢åˆå§‹åŒ–é€»è¾‘ ---
    window.onload = function() {
        initDateSelectors();
        initFireworks(); // åˆå§‹åŒ–Canvaså°ºå¯¸
    };

    window.onresize = function() {
        initFireworks(); // çª—å£å¤§å°æ”¹å˜æ—¶é‡ç½®Canvas
    };

    function initDateSelectors() {
        const yearSel = document.getElementById('sel-year');
        const monthSel = document.getElementById('sel-month');
        const daySel = document.getElementById('sel-day');
        const currentYear = new Date().getFullYear();

        for (let i = 0; i < 4; i++) {
            let y = currentYear + i;
            let opt = document.createElement('option');
            opt.value = y + 'å¹´';
            opt.innerHTML = y;
            yearSel.appendChild(opt);
        }
        for (let i = 1; i <= 12; i++) {
            let opt = document.createElement('option');
            opt.value = i + 'æœˆ';
            opt.innerHTML = i + 'æœˆ';
            monthSel.appendChild(opt);
        }
        for (let i = 1; i <= 31; i++) {
            let opt = document.createElement('option');
            opt.value = i + 'æ—¥';
            opt.innerHTML = i + 'æ—¥';
            daySel.appendChild(opt);
        }
    }

    // --- é¢„æµ‹é€»è¾‘ ---
    function startPrediction() {
        const name = document.getElementById('username').value.trim();
        const loc = document.getElementById('exam-loc').value.trim();
        const year = document.getElementById('sel-year').value;
        const month = document.getElementById('sel-month').value;
        const day = document.getElementById('sel-day').value;

        if (!name) { alert("è¯·è¾“å…¥æ‚¨çš„å§“åï¼"); return; }
        if (!year || !month || !day) { alert("è¯·å®Œæ•´é€‰æ‹©è€ƒè¯•çš„å¹´ã€æœˆã€æ—¥ï¼"); return; }
        if (!loc) { alert("è¯·è¾“å…¥è€ƒè¯•åœ°ç‚¹ï¼"); return; }

        const fullTime = year + month + day;

        document.getElementById('input-section').style.display = 'none';
        document.getElementById('progress-section').style.display = 'block';

        let progress = 0;
        const progressBar = document.getElementById('progress-fill');
        const progressText = document.getElementById('progress-text');
        
        const timer = setInterval(() => {
            const increment = Math.random() * 1.5 + 0.2; 
            progress += increment;
            
            if (progress >= 100) {
                progress = 100;
                clearInterval(timer);
                setTimeout(() => {
                    showResult(name, fullTime, loc);
                }, 800); 
            }

            progressBar.style.width = progress + '%';
            
            if(progress < 25) {
                progressText.innerText = `æ­£åœ¨è¿æ¥è€ƒè¯•è¿åŠ¿æ•°æ®åº“... ${Math.floor(progress)}%`;
            } else if (progress < 50) {
                progressText.innerText = `æ­£åœ¨åˆ†æä½ çš„ç”³è®º/è¡Œæµ‹å®åŠ›... ${Math.floor(progress)}%`;
            } else if (progress < 85) {
                progressText.innerText = `æ­£åœ¨è®¡ç®—å²—ä½ç«äº‰æ¯”ä¸èƒœç‡... ${Math.floor(progress)}%`;
            } else {
                progressText.innerText = `ç”Ÿæˆæœ€ç»ˆé¢„æµ‹æŠ¥å‘Š... ${Math.floor(progress)}%`;
            }

        }, 80); 
    }

    function showResult(name, time, loc) {
        document.getElementById('progress-section').style.display = 'none';
        const resultSection = document.getElementById('result-section');
        const resultContent = document.getElementById('result-content');

        resultContent.innerHTML = `
            <span class="highlight">${name}</span><br>
            å°†åœ¨ <span class="exam-info">${time}</span> çš„<br>
            <span class="exam-info">${loc}</span> è€ƒè¯•ä¸­<br>
            <span class="highlight" style="font-size: 26px; margin-top:12px; display:block;">æˆåŠŸä¸Šå²¸ï¼</span>
        `;

        resultSection.style.display = 'block';

        // è§¦å‘çƒŸèŠ±
        startFireworks();
    }

    function resetPage() {
        document.getElementById('result-section').style.display = 'none';
        document.getElementById('progress-section').style.display = 'none';
        document.getElementById('input-section').style.display = 'block';
        document.getElementById('progress-fill').style.width = '0%';
        
        // åœæ­¢çƒŸèŠ±
        stopFireworks();
    }

    // --- çƒŸèŠ±ç‰¹æ•ˆé€»è¾‘ (Canvas) ---
    const canvas = document.getElementById('fireworks-canvas');
    const ctx = canvas.getContext('2d');
    let particles = [];
    let animationId;
    let isFireworksActive = false;

    function initFireworks() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }

    // ç²’å­ç±»
    class Particle {
        constructor(x, y, color) {
            this.x = x;
            this.y = y;
            this.color = color;
            // éšæœºé€Ÿåº¦å’Œè§’åº¦
            const angle = Math.random() * Math.PI * 2;
            const velocity = Math.random() * 4 + 1; // çˆ†ç‚¸èŒƒå›´
            this.vx = Math.cos(angle) * velocity;
            this.vy = Math.sin(angle) * velocity;
            this.alpha = 1; // é€æ˜åº¦
            this.decay = Math.random() * 0.015 + 0.005; // æ¶ˆå¤±é€Ÿåº¦
        }

        draw() {
            ctx.save();
            ctx.globalAlpha = this.alpha;
            ctx.beginPath();
            ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
            ctx.fillStyle = this.color;
            ctx.fill();
            ctx.restore();
        }

        update() {
            this.x += this.vx;
            this.y += this.vy;
            this.vy += 0.05; // é‡åŠ›æ¨¡æ‹Ÿ
            this.vx *= 0.98; // æ‘©æ“¦åŠ›
            this.vy *= 0.98;
            this.alpha -= this.decay;
        }
    }

    function createExplosion() {
        const x = Math.random() * canvas.width;
        // è®©çˆ†ç‚¸ä¸»è¦å‘ç”Ÿåœ¨å±å¹•ä¸ŠåŠéƒ¨åˆ†ï¼Œé¿å…é®æŒ¡æ–‡å­—å¤ªå¤š
        const y = Math.random() * (canvas.height * 0.6); 
        const colors = ['#ff4d4d', '#ff9f43', '#feca57', '#54a0ff', '#5f27cd', '#d93025'];
        const color = colors[Math.floor(Math.random() * colors.length)];

        for (let i = 0; i < 30; i++) { // æ¯ä¸ªçƒŸèŠ±30ä¸ªç²’å­
            particles.push(new Particle(x, y, color));
        }
    }

    function animateFireworks() {
        if (!isFireworksActive) return;

        // æ¯ä¸€å¸§æ¸…é™¤ç”»å¸ƒï¼Œä¿ç•™ä¸€ç‚¹æ‹–å°¾æ•ˆæœï¼ˆå¯é€‰ï¼Œè¿™é‡Œç”¨å…¨æ¸…ï¼‰
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // éšæœºäº§ç”Ÿæ–°çš„çƒŸèŠ± (æ¦‚ç‡æ§åˆ¶é¢‘ç‡)
        if (Math.random() < 0.05) { 
            createExplosion();
        }

        // æ›´æ–°å’Œç»˜åˆ¶æ‰€æœ‰ç²’å­
        for (let i = particles.length - 1; i >= 0; i--) {
            particles[i].update();
            particles[i].draw();

            // ç§»é™¤æ¶ˆå¤±çš„ç²’å­
            if (particles[i].alpha <= 0) {
                particles.splice(i, 1);
            }
        }

        animationId = requestAnimationFrame(animateFireworks);
    }

    function startFireworks() {
        if (isFireworksActive) return;
        isFireworksActive = true;
        // ç«‹å³äº§ç”Ÿå‡ ä¸ªçˆ†ç‚¸ä½œä¸ºå¼€åœº
        createExplosion();
        createExplosion();
        createExplosion();
        animateFireworks();
    }

    function stopFireworks() {
        isFireworksActive = false;
        cancelAnimationFrame(animationId);
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        particles = [];
    }
</script>

</body>
</html>